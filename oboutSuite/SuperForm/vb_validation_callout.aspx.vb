Imports Obout.SuperForm
Imports System.Data
Imports System.Data.OleDb
Imports System.Collections.Generic
Imports System.Web.UI.WebControls
Imports Obout.Interface
Imports AjaxControlToolkit
Partial Class SuperForm_vb_validation_callout
    Inherits System.Web.UI.Page
    Dim SuperForm1 As Obout.SuperForm.SuperForm
    Sub Page_load(ByVal sender As Object, ByVal e As EventArgs)
        SuperForm1 = New SuperForm()
        SuperForm1.ID = "SuperForm1"
        SuperForm1.DataSourceID = "SqlDataSource1"
        SuperForm1.AutoGenerateRows = False
        SuperForm1.AutoGenerateInsertButton = True
        SuperForm1.AutoGenerateEditButton = True
        SuperForm1.AutoGenerateDeleteButton = True
        Dim keyNames1() As String = {"EmployeeID"}
        SuperForm1.DataKeyNames = keyNames1
        SuperForm1.AllowPaging = True
        SuperForm1.ValidationGroup = "Group1"
        SuperForm1.DefaultMode = DetailsViewMode.Insert
        AddHandler SuperForm1.ItemCommand, AddressOf SuperForm1_ItemCommand

        Dim field1 As Obout.SuperForm.BoundField = New Obout.SuperForm.BoundField()
        field1.DataField = "EmployeeID"
        field1.HeaderText = "Employee ID"
        field1.ReadOnly = True
        field1.InsertVisible = False

        Dim field2Required As RequiredFieldValidator = New RequiredFieldValidator()
        field2Required.ID = "FirstNameValidator"
        field2Required.Display = ValidatorDisplay.None
        field2Required.ErrorMessage = "First Name is mandatory"

        Dim field2CalloutExtender As ValidatorCalloutExtender = New ValidatorCalloutExtender()
        field2CalloutExtender.ID = "FirstNameValidatorCallout"
        field2CalloutExtender.TargetControlID = "FirstNameValidator"
        field2CalloutExtender.Width = 250
        field2CalloutExtender.HighlightCssClass = "highlight"
        field2CalloutExtender.WarningIconImageUrl = "resources/icons/warning.gif"
        field2CalloutExtender.CloseImageUrl = "resources/icons/close.gif"

        Dim field2 As Obout.SuperForm.BoundField = New Obout.SuperForm.BoundField()
        field2.DataField = "FirstName"
        field2.HeaderText = "First Name"
        field2.Validators.Add(field2Required)
        field2.Validators.Add(field2CalloutExtender)

        Dim field3Required As RequiredFieldValidator = New RequiredFieldValidator()
        field3Required.ID = "LastNameValidator"
        field3Required.Display = ValidatorDisplay.None
        field3Required.ErrorMessage = "Last Name is mandatory"
        field3Required.Text = "*"

        Dim field3CalloutExtender As ValidatorCalloutExtender = New ValidatorCalloutExtender()
        field3CalloutExtender.ID = "LastNameValidatorCallout"
        field3CalloutExtender.TargetControlID = "LastNameValidator"
        field3CalloutExtender.Width = 250
        field3CalloutExtender.HighlightCssClass = "highlight"
        field3CalloutExtender.WarningIconImageUrl = "resources/icons/warning.gif"
        field3CalloutExtender.CloseImageUrl = "resources/icons/close.gif"

        Dim field3 As Obout.SuperForm.BoundField = New Obout.SuperForm.BoundField()
        field3.DataField = "LastName"
        field3.HeaderText = "Last Name"
        field3.Validators.Add(field3Required)
        field3.Validators.Add(field3CalloutExtender)

        Dim field4Required As RequiredFieldValidator = New RequiredFieldValidator()
        field4Required.ID = "TitleOfCourtesyValidator1"
        field4Required.Display = ValidatorDisplay.None
        field4Required.ErrorMessage = "Courtesy Title is mandatory"
        field4Required.Text = "*"

        Dim field4Callout1 As ValidatorCalloutExtender = New ValidatorCalloutExtender()
        field4Callout1.ID = "TitleOfCourtesyValidatorCallout1"
        field4Callout1.TargetControlID = "TitleOfCourtesyValidator1"
        field4Callout1.Width = 250
        field4Callout1.HighlightCssClass = "highlight"
        field4Callout1.WarningIconImageUrl = "resources/icons/warning.gif"
        field4Callout1.CloseImageUrl = "resources/icons/close.gif"

        Dim field4Custom As CustomValidator = New CustomValidator()
        field4Custom.ID = "TitleOfCourtesyValidator2"
        AddHandler field4Custom.ServerValidate, AddressOf ValidateTitle
        field4Custom.Display = ValidatorDisplay.Dynamic
        field4Custom.ErrorMessage = "Courtesy Title needs to be 'Mr.', 'Ms.', 'Mrs.' or 'Dr.'"
        field4Custom.Text = "Courtesy Title needs to be 'Mr.', 'Ms.', 'Mrs.' or 'Dr.'"

        Dim field4 As Obout.SuperForm.BoundField = New Obout.SuperForm.BoundField()
        field4.DataField = "TitleOfCourtesy"
        field4.HeaderText = "Courtesy Title"
        field4.Validators.Add(field4Required)
        field4.Validators.Add(field4Callout1)
        field4.Validators.Add(field4Custom)

        Dim field5Required As RequiredFieldValidator = New RequiredFieldValidator()
        field5Required.ID = "BirthDateValidator1"
        field5Required.Display = ValidatorDisplay.None
        field5Required.ErrorMessage = "Birth Date is mandatory"
        field5Required.Text = "*"

        Dim field5Callout1 As ValidatorCalloutExtender = New ValidatorCalloutExtender()
        field5Callout1.ID = "BirthDateValidatorCallout1"
        field5Callout1.TargetControlID = "BirthDateValidator1"
        field5Callout1.Width = 250
        field5Callout1.HighlightCssClass = "highlight"
        field5Callout1.WarningIconImageUrl = "resources/icons/warning.gif"
        field5Callout1.CloseImageUrl = "resources/icons/close.gif"

        Dim field5Range As RangeValidator = New RangeValidator()
        field5Range.ID = "BirthDateValidator2"
        field5Range.Display = ValidatorDisplay.None
        field5Range.MinimumValue = "1900/1/1"
        field5Range.MaximumValue = "2039/12/31"
        field5Range.Type = ValidationDataType.Date
        field5Range.ErrorMessage = "Birth Date needs to be in this format: mm/dd/yyyy"
        field5Range.Text = "*"

        Dim field5Callout2 As ValidatorCalloutExtender = New ValidatorCalloutExtender()
        field5Callout2.ID = "BirthDateValidatorCallout2"
        field5Callout2.TargetControlID = "BirthDateValidator2"
        field5Callout2.Width = 250
        field5Callout2.HighlightCssClass = "highlight"
        field5Callout2.WarningIconImageUrl = "resources/icons/warning.gif"
        field5Callout2.CloseImageUrl = "resources/icons/close.gif"

        Dim field5 As Obout.SuperForm.DateField = New Obout.SuperForm.DateField()
        field5.DataField = "BirthDate"
        field5.HeaderText = "Birth Date"
        field5.DataFormatString = "{0:MM/dd/yyyy}"
        field5.ApplyFormatInEditMode = True
        field5.Validators.Add(field5Required)
        field5.Validators.Add(field5Callout1)
        field5.Validators.Add(field5Range)
        field5.Validators.Add(field5Callout2)

        Dim field6Required As RequiredFieldValidator = New RequiredFieldValidator()
        field6Required.ID = "HomePhoneValidator1"
        field6Required.Display = ValidatorDisplay.None
        field6Required.ErrorMessage = "Home Phone is mandatory"
        field6Required.Text = "*"

        Dim field6Callout1 As ValidatorCalloutExtender = New ValidatorCalloutExtender()
        field6Callout1.ID = "HomePhoneValidatorCallout1"
        field6Callout1.TargetControlID = "HomePhoneValidator1"
        field6Callout1.Width = 250
        field6Callout1.HighlightCssClass = "highlight"
        field6Callout1.WarningIconImageUrl = "resources/icons/warning.gif"
        field6Callout1.CloseImageUrl = "resources/icons/close.gif"

        Dim field6Range As RegularExpressionValidator = New RegularExpressionValidator()
        field6Range.ID = "HomePhoneValidator2"
        field6Range.Display = ValidatorDisplay.None
        field6Range.ValidationExpression = "^(\(?\s*\d{3}\s*[\)\-\.]?\s*)?[1-9]\d{2}\s*[\-\.]\s*\d{4}$"
        field6Range.ErrorMessage = "Home Phone must be in this format (###) ###-####"
        field6Range.Text = "*"

        Dim field6Callout2 As ValidatorCalloutExtender = New ValidatorCalloutExtender()
        field6Callout2.ID = "HomePhoneValidatorCallout2"
        field6Callout2.TargetControlID = "HomePhoneValidator2"
        field6Callout2.Width = 250
        field6Callout2.HighlightCssClass = "highlight"
        field6Callout2.WarningIconImageUrl = "resources/icons/warning.gif"
        field6Callout2.CloseImageUrl = "resources/icons/close.gif"

        Dim field6 As Obout.SuperForm.BoundField = New Obout.SuperForm.BoundField()
        field6.DataField = "HomePhone"
        field6.HeaderText = "Home Phone"
        field6.Validators.Add(field6Required)
        field6.Validators.Add(field6Callout1)
        field6.Validators.Add(field6Range)
        field6.Validators.Add(field6Callout2)

        SuperForm1.Fields.Add(field1)
        SuperForm1.Fields.Add(field2)
        SuperForm1.Fields.Add(field3)
        SuperForm1.Fields.Add(field4)
        SuperForm1.Fields.Add(field5)
        SuperForm1.Fields.Add(field6)

        SuperForm1Container.Controls.Add(SuperForm1)
    End Sub
    Sub ValidateTitle(ByVal sender As Object, ByVal e As ServerValidateEventArgs)

        If (e.Value <> "Mr." And e.Value <> "Ms." And e.Value <> "Mrs." And e.Value <> "Dr.") Then

            e.IsValid = False
            Return
        End If

        e.IsValid = True
    End Sub

    Sub SuperForm1_ItemCommand(ByVal sender As Object, ByVal e As DetailsViewCommandEventArgs)

        If (e.CommandName = "Cancel") Then

            SuperForm1.DefaultMode = DetailsViewMode.ReadOnly
        End If
    End Sub

End Class
