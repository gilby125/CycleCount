Imports Obout.SuperForm
Imports System.Data
Imports System.Data.OleDb
Imports System.Collections.Generic
Imports System.Web.UI.WebControls
Imports Obout.Interface
Partial Class SuperForm_vb_validation_summary
    Inherits System.Web.UI.Page
    Dim SuperForm1 As Obout.SuperForm.SuperForm
    Sub Page_load(ByVal sender As Object, ByVal e As EventArgs)
        SuperForm1 = New SuperForm()
        SuperForm1.Title = "Employee Form"
        SuperForm1.DataSourceID = "SqlDataSource1"
        SuperForm1.AutoGenerateRows = False
        SuperForm1.AutoGenerateInsertButton = True
        SuperForm1.AutoGenerateEditButton = True
        SuperForm1.AutoGenerateDeleteButton = True
        Dim keyNames1() As String = {"EmployeeID"}
        SuperForm1.DataKeyNames = keyNames1
        SuperForm1.AllowPaging = True

        SuperForm1.ValidationGroup = "Group1"
        SuperForm1.DefaultMode = DetailsViewMode.Insert
        AddHandler SuperForm1.ItemCommand, AddressOf SuperForm1_ItemCommand

        Dim field2Required As RequiredFieldValidator = New RequiredFieldValidator()
        field2Required.ID = "RequiredFieldValidator1"
        field2Required.Display = ValidatorDisplay.Dynamic
        field2Required.ErrorMessage = "First Name is mandatory"
        field2Required.Text = "*"
        field2Required.ValidationGroup = "Group1"

        Dim field3Required As RequiredFieldValidator = New RequiredFieldValidator()
        field3Required.ID = "RequiredFieldValidator2"
        field3Required.Display = ValidatorDisplay.Dynamic
        field3Required.ErrorMessage = "Last Name is mandatory"
        field3Required.Text = "*"
        field3Required.ValidationGroup = "Group1"

        Dim field4Required As RequiredFieldValidator = New RequiredFieldValidator()
        field4Required.ID = "RequiredFieldValidator3"
        field4Required.Display = ValidatorDisplay.Dynamic
        field4Required.ErrorMessage = "Courtesy Title is mandatory"
        field4Required.Text = "*"
        field4Required.ValidationGroup = "Group1"

        Dim field4Custom As CustomValidator = New CustomValidator()
        field4Custom.ID = "CustomValidator1"
        AddHandler field4Custom.ServerValidate, AddressOf ValidateTitle
        field4Custom.Display = ValidatorDisplay.Dynamic
        field4Custom.ErrorMessage = "Courtesy Title needs to be 'Mr.', 'Ms.', 'Mrs.' or 'Dr.'"
        field4Custom.Text = "*"
        field4Custom.ValidationGroup = "Group1"

        Dim field5Required As RequiredFieldValidator = New RequiredFieldValidator()
        field5Required.ID = "RequiredFieldValidator4"
        field5Required.Display = ValidatorDisplay.Dynamic
        field5Required.ErrorMessage = "Birth Date is mandatory"
        field5Required.Text = "*"
        field5Required.ValidationGroup = "Group1"

        Dim field5Custom As RangeValidator = New RangeValidator()
        field5Custom.ID = "RangeValidator1"
        field5Custom.Display = ValidatorDisplay.Dynamic
        field5Custom.MinimumValue = "1900/1/1"
        field5Custom.MaximumValue = "2039/12/31"
        field5Custom.Type = ValidationDataType.Date
        field5Custom.ErrorMessage = "Birth Date needs to be in this format: mm/dd/yyyy"
        field5Custom.Text = "*"
        field5Custom.ValidationGroup = "Group1"

        Dim field6Required As RequiredFieldValidator = New RequiredFieldValidator()
        field6Required.ID = "RequiredFieldValidator5"
        field6Required.Display = ValidatorDisplay.Dynamic
        field6Required.ErrorMessage = "Home Phone is mandatory"
        field6Required.Text = "*"
        field6Required.ValidationGroup = "Group1"

        Dim field6Custom As RegularExpressionValidator = New RegularExpressionValidator()
        field6Custom.ID = "RegularExpressionValidator1"
        field6Custom.Display = ValidatorDisplay.Dynamic
        field6Custom.ValidationExpression = "^(\(?\s*\d{3}\s*[\)\-\.]?\s*)?[1-9]\d{2}\s*[\-\.]\s*\d{4}$"
        field6Custom.ErrorMessage = "Home Phone must have this format (###) ###-####"
        field6Custom.Text = "*"
        field6Custom.ValidationGroup = "Group1"

        Dim field1 As Obout.SuperForm.BoundField = New Obout.SuperForm.BoundField()
        field1.DataField = "EmployeeID"
        field1.HeaderText = "Employee ID"
        field1.ReadOnly = True
        field1.InsertVisible = False

        Dim field2 As Obout.SuperForm.BoundField = New Obout.SuperForm.BoundField()
        field2.DataField = "FirstName"
        field2.HeaderText = "First Name"
        field2.Validators.Add(field2Required)

        Dim field3 As Obout.SuperForm.BoundField = New Obout.SuperForm.BoundField()
        field3.DataField = "LastName"
        field3.HeaderText = "Last Name"
        field3.Validators.Add(field3Required)

        Dim field4 As Obout.SuperForm.BoundField = New Obout.SuperForm.BoundField()
        field4.DataField = "TitleOfCourtesy"
        field4.HeaderText = "Courtesy Title"
        field4.Validators.Add(field4Required)
        field4.Validators.Add(field4Custom)

        Dim field5 As Obout.SuperForm.DateField = New Obout.SuperForm.DateField()
        field5.DataField = "BirthDate"
        field5.HeaderText = "Birth Date"
        field5.DataFormatString = "{0:MM/dd/yyyy}"
        field5.ApplyFormatInEditMode = True
        field5.Validators.Add(field5Required)
        field5.Validators.Add(field5Custom)

        Dim field6 As Obout.SuperForm.BoundField = New Obout.SuperForm.BoundField()
        field6.DataField = "HomePhone"
        field6.HeaderText = "Home Phone"
        field6.Validators.Add(field6Required)
        field6.Validators.Add(field6Custom)

        SuperForm1.Fields.Add(field1)
        SuperForm1.Fields.Add(field2)
        SuperForm1.Fields.Add(field3)
        SuperForm1.Fields.Add(field4)
        SuperForm1.Fields.Add(field5)
        SuperForm1.Fields.Add(field6)

        SuperForm1Container.Controls.Add(SuperForm1)

    End Sub
    Sub ValidateTitle(ByVal sender As Object, ByVal e As ServerValidateEventArgs)

        If (e.Value <> "Mr." And e.Value <> "Ms." And e.Value <> "Mrs." And e.Value <> "Dr.") Then

            e.IsValid = False
            Return
        End If

        e.IsValid = True
    End Sub

    Sub SuperForm1_ItemCommand(ByVal sender As Object, ByVal e As DetailsViewCommandEventArgs)

        If (e.CommandName = "Cancel") Then

            SuperForm1.DefaultMode = DetailsViewMode.ReadOnly
        End If

    End Sub

End Class
